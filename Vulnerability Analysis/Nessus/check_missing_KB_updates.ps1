### This Script was created by GPT during the Vulnerability Analysis stage of the vulnAD.lab Vuln Assessment/Pen-Test

$KBs = @{
    "KB4519338" = "October 2019 Security Update - Addresses various vulnerabilities including RCE and elevation of privilege."
    "KB4523205" = "November 2019 Security Update - Includes fixes for security issues that could allow RCE if a user opens a specially crafted document."
    "KB4551853" = "May 2020 Security Update - Fixes vulnerabilities that could allow an attacker to execute code remotely on a target system."
    "KB5003171" = "May 2021 Security Update - Patches critical vulnerabilities across several Windows components that could be exploited for RCE."
    "KB5004244" = "July 2021 Security Update - Updates security for Windows operating systems to address vulnerabilities."
    "KB5005030" = "August 2021 Security Update - Addresses multiple security vulnerabilities in Windows OS."
    "KB5003646" = "June 2021 Security Update - Provides important security updates for the Windows Operating System."
    "KB5007206" = "November 2021 Security Update - Fixes issues in Windows that could be exploited by an attacker to gain elevated privileges."
    "KB5006672" = "October 2021 Security Update - Addresses vulnerabilities that could be used in elevation of privilege attacks."
    "KB5005568" = "September 2021 Security Update - Includes security improvements for internal OS functionality."
    "KB5004947" = "July 2021 Out-of-band Security Update - Addresses the PrintNightmare vulnerability in the Windows Print Spooler service."
    "KB5001342" = "April 2021 Security Update - Critical updates for security vulnerabilities in Windows."
    "KB4598230" = "January 2021 Security Update - Provides updates to improve security when Windows performs basic operations."
    "KB4586793" = "November 2020 Security Update - Addresses multiple security issues in Windows components."
    "KB4561600" = "June 2020 Security Update - Includes security updates to various Windows components."
    "KB4565349" = "August 2020 Security Update - Addresses several vulnerabilities that could allow RCE."
    "KB4549949" = "April 2020 Security Update - Fixes critical vulnerabilities that could be exploited for RCE."
    "KB4538461" = "March 2020 Security Update - Provides patches for multiple security vulnerabilities in Windows."
    "KB4534273" = "January 2020 Security Update - Includes security updates for Windows operating system."
    "KB4516115" = "September 2019 Security Update - Security update for Adobe Flash Player."
    "KB4493478" = "April 2019 Security Update - Addresses an issue that may cause an error when connecting to a Remote Desktop server."
    "KB4477029" = "November 2018 Security Update - Updates to improve security when Windows performs basic operations."
    "KB4471331" = "December 2018 Security Update - Security updates for Adobe Flash Player."
    "KB4514366" = "**Test: Showing as installed on DC** September 2019 Update - Provides cumulative reliability improvements in .NET Framework 3.5 and 4.7.2."
}

foreach ($KB in $KBs.Keys) 
{
    $installed = Get-HotFix -Id $KB -ErrorAction SilentlyContinue
    if ($installed) 
    {
        Write-Host "$KB is installed. $($KBs[$KB])" -ForegroundColor Green
    } 
    
    else 
    {
        Write-Host "$KB is missing. $($KBs[$KB])" -ForegroundColor Red
    }
}
